{% extends 'reviews/base.html' %}

{% block title %}Abonnements - LITReview{% endblock %}

{% block content %}

<div class="container">
    <h1 style="text-align: center; margin-bottom: 32px;">
         Abonnements
    </h1>
    
    <!-- Formulaire pour suivre un utilisateur -->
    <div class="card" style="padding: 24px; margin-bottom: 32px; max-width: 600px; margin-left: auto; margin-right: auto;">
        <h2 style="margin-bottom: 16px;">Suivre un nouvel utilisateur</h2>
        <form method="post" style="display: flex; gap: 16px;">
            {% csrf_token %}
            <div style="flex: 1;">
                {{ form.username }}
            </div>
            <button type="submit" class="btn btn-primary">Envoyer</button>
        </form>
    </div>
    <br> <hr> 
    <!-- Grille : Abonnements & Abonnés -->
    <div class="subscriptions-grid">
        <!-- Section Abonnements (utilisateurs suivis) -->
        <div class="subscription-section">
            <h3> Abonnements </h3>
            <hr>
            {% if following %}
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>Utilisateur</th>
                            <th style="width: 150px;">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for follow in following %}
                        <tr>
                            <td>{{ follow.followed_user.username }}</td>
                            <td>
                                <form method="post" action="{% url 'unfollow_user' follow.followed_user.id %}">
                                    {% csrf_token %}
                                    <button type="submit" class="btn btn-danger btn-sm">
                                        Désabonner
                                    </button>
                                </form>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p style="padding: 16px 0;">
                    Vous ne suivez personne pour le moment.
                </p>
            {% endif %}
        </div>
        
        <br> <hr>
        <div class="subscription-section">
            <h3> Abonnés</h3>
            <hr>
            {% if followers %}
                <table class="table table-bordered table-striped text-center">
    <thead>
        <tr>
            <th>Utilisateur</th>
        </tr>
    </thead>
    <tbody>
        {% for follower in followers %}
        <tr>
            <td>{{ follower.user.username }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

            {% else %}
                <p style="padding: 16px 0;">
                    Personne ne vous suit pour le moment.
                </p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}